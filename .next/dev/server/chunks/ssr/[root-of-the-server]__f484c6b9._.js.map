{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 54, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Travis%20Irwin/bookstore-ecommerce/lib/supabase/server.ts"],"sourcesContent":["// lib/supabase/server.ts\r\nimport { createServerClient, type CookieOptions } from '@supabase/ssr';\r\nimport { cookies } from 'next/headers';\r\n\r\n/**\r\n * Supabase client for SERVER usage (RSC, API routes, server actions)\r\n * Handles auth cookies automatically.\r\n */\r\nexport async function supabaseServer() {\r\n  // Next 16 returns a Promise\r\n  const cookieStore = await cookies();\r\n\r\n  return createServerClient(\r\n    process.env.NEXT_PUBLIC_SUPABASE_URL!,\r\n    process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!,\r\n    {\r\n      cookies: {\r\n        get(name: string) {\r\n          return cookieStore.get(name)?.value;\r\n        },\r\n        set(name: string, value: string, options?: CookieOptions) {\r\n          try {\r\n            cookieStore.set({ name, value, ...(options ?? {}) });\r\n          } catch {}\r\n        },\r\n        remove(name: string, options?: CookieOptions) {\r\n          try {\r\n            cookieStore.set({ name, value: '', ...(options ?? {}), maxAge: 0 });\r\n          } catch {}\r\n        },\r\n      },\r\n    }\r\n  );\r\n}\r\n"],"names":[],"mappings":"AAAA,yBAAyB;;;;;AACzB;AAAA;AACA;;;AAMO,eAAe;IACpB,4BAA4B;IAC5B,MAAM,cAAc,MAAM,IAAA,oKAAO;IAEjC,OAAO,IAAA,yNAAkB,sUAGvB;QACE,SAAS;YACP,KAAI,IAAY;gBACd,OAAO,YAAY,GAAG,CAAC,OAAO;YAChC;YACA,KAAI,IAAY,EAAE,KAAa,EAAE,OAAuB;gBACtD,IAAI;oBACF,YAAY,GAAG,CAAC;wBAAE;wBAAM;wBAAO,GAAI,WAAW,CAAC,CAAC;oBAAE;gBACpD,EAAE,OAAM,CAAC;YACX;YACA,QAAO,IAAY,EAAE,OAAuB;gBAC1C,IAAI;oBACF,YAAY,GAAG,CAAC;wBAAE;wBAAM,OAAO;wBAAI,GAAI,WAAW,CAAC,CAAC;wBAAG,QAAQ;oBAAE;gBACnE,EAAE,OAAM,CAAC;YACX;QACF;IACF;AAEJ","debugId":null}},
    {"offset": {"line": 98, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Travis%20Irwin/bookstore-ecommerce/app/page.tsx"],"sourcesContent":["import { supabaseServer } from '@/lib/supabase/server';\r\n\r\n// Type for URL search parameters\r\ntype Search = Record<string, string | string[]>;\r\n\r\nexport default async function Page({ searchParams }: { searchParams: Promise<Search> }) {\r\n  // Get and parse search parameters\r\n  const params = await searchParams;\r\n  const q = String(params?.q ?? '');               // Search query\r\n  const sort = String(params?.sort ?? 'created_at'); // Sort field\r\n  const available = String(params?.available) === '1'; // In stock filter\r\n\r\n  // Initialize Supabase client\r\n  const supabase = await supabaseServer();\r\n  \r\n  // Check if user is admin\r\n  const { data: { user } } = await supabase.auth.getUser();\r\n  const { data: profile } = user \r\n    ? await supabase.from('profiles').select('role').eq('id', user.id).single() \r\n    : { data: null };\r\n  const isAdmin = profile?.role === 'admin';\r\n\r\n  // Build the base query\r\n  let query = supabase\r\n    .from('items')\r\n    .select('id, name, price_cents, stock, img_url, active, created_at');\r\n\r\n  // Add search filter if query exists\r\n  if (q) {\r\n    query = query.ilike('name', `%${q.trim()}%`);\r\n  }\r\n  \r\n  // Apply visibility and stock filters\r\n  if (!isAdmin) {\r\n    // Regular users only see active items\r\n    query = query.eq('active', true);\r\n  }\r\n  \r\n  // Apply stock filter if requested\r\n  if (available) {\r\n    query = query.gt('stock', 0);\r\n  }\r\n  \r\n  // Apply sorting (ascending for names, descending for others)\r\n  query = query.order(sort, { ascending: sort === 'name' });\r\n\r\n  // Execute query\r\n  const { data: items, error } = await query;\r\n  if (error) return <div className=\"p-6 text-red-600\">Error: {error.message}</div>;\r\n\r\n  return (\r\n    <main className=\"p-6 space-y-4\">\r\n      <h1 className=\"text-2xl font-bold\">Catalog (example)</h1>\r\n      <form className=\"flex flex-wrap gap-2\" aria-label=\"catalog filters\">\r\n        <label htmlFor=\"q\" className=\"sr-only\">Search</label>\r\n        <input id=\"q\" name=\"q\" placeholder=\"Search by nameâ€¦\" defaultValue={q} className=\"border rounded px-3 py-2\" />\r\n        <label htmlFor=\"sort\" className=\"flex items-center\">Sort:\r\n          <select id=\"sort\" name=\"sort\" defaultValue={sort} className=\"ml-2 border rounded px-3 py-2\" aria-label=\"Sort items\">\r\n            <option value=\"created_at\">Newest</option>\r\n            <option value=\"name\">Name</option>\r\n            <option value=\"price_cents\">Price</option>\r\n          </select>\r\n        </label>\r\n        <label className=\"flex items-center gap-2\">\r\n          <input type=\"checkbox\" name=\"available\" value=\"1\" defaultChecked={available} /> In stock only\r\n        </label>\r\n        <button className=\"border rounded px-3 py-2\">Apply</button>\r\n      </form>\r\n\r\n      <section className=\"grid gap-4 sm:grid-cols-2 lg:grid-cols-3\">\r\n        {items?.map((it) => (\r\n          <article key={it.id} className=\"rounded-2xl shadow p-4\">\r\n            {it.img_url && <img src={it.img_url} alt={it.name} className=\"w-full h-40 object-cover rounded-xl\" />}\r\n            <div className=\"mt-2 font-semibold\">{it.name}</div>\r\n            <div>${(it.price_cents / 100).toFixed(2)}</div>\r\n            <div className=\"mt-2 text-sm text-gray-500\">ID: {it.id}</div>\r\n            <div className=\"flex gap-2 mt-3\">\r\n              <a \r\n                href={`/book-ex?id=${it.id}`} \r\n                className=\"inline-block border rounded-xl px-3 py-2 bg-blue-50 hover:bg-blue-100\"\r\n              >\r\n                View Details\r\n              </a>\r\n            </div>\r\n          </article>\r\n        ))}\r\n      </section>\r\n    </main>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}}]
}